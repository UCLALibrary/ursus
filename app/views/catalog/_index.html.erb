<!-- SINAI -->
<% if Flipflop.sinai? %>
  <% doc_presenter = index_presenter(document) %>
  <div class="document__list-item-wrapper document__list-item-wrapper--sinai">
    <!-- default partial to display solr document fields in catalog index view -->

    <%# THUMBNAIL %>
    <% if presenter(document).thumbnail.exists? && tn = presenter(document).thumbnail.thumbnail_tag({}, counter: document_counter_with_offset(document_counter)) %>
      <div class="document__gallery-thumbnail document__gallery-thumbnail--sinai"><%= tn %></div>
    <% end %>
<!-- ----------------- -->

<div class="document__list-item-wrapper document__list-item-wrapper--sinai">
  <div class='metadata-block__group--collection-pg'>
      <!-- Line 1 -->
      <!-- [Shelfmark], [Date.creation]. [Form], [Format.extent], [Collection] -->

<!-- ------------------ -->

<!-- Line 2 -->
<!-- Title(s)
  Uniform title (clickable facet that results in a search of the facet term)
  and Descriptive title fields) -->
<% doc_presenter = show_presenter(document) %>
<% sinai_index_title = Ursus::SinaiIndexTitleMetadataPresenter.new(document: doc_presenter.fields_to_render).sinai_index_title_terms %>

<div class='metadata-block'>
  <% if sinai_index_title.length > 0 %>
      <div class='metadata-block__group--collection-pg'>

        <div class="metadata-block__label-key">
          TITLE
        </div>

        <% title = ['uniform_title_tesim', 'descriptive_title_tesim'] %>
        <div class="metadata-block__label-value">
        <% if title.length > 0 %>
          <% all_title_fields = "" %>
          <% title.each do |field| -%>
            <% if sinai_index_title[field] %>
              <% title_field = (doc_presenter.field_value sinai_index_title[field]) + ', ' %>
              <% all_title_fields << title_field %>
            <% end %>
          <% end %>
          <%= all_title_fields.delete_suffix(', ').html_safe %>
        <% end %>
        </div>
    </div>
  <% end %>


<!-- ------------------- -->

        <!-- Line 3 -->
        <!-- Language(s) (clickable facet that results in a search of the facet term) -->
        <!-- Line 4 -->
        <!-- Genre(s) (clickable facet that results in a search of the facet term) -->


      <%#= render 'catalog/sinai_work_record/sinai_index_metadata', document: document %>
<!-- ------------------- -->

  <% doc_presenter = show_presenter(document) %>
  <% sinai_index = Ursus::SinaiIndexMetadataPresenter.new(document: doc_presenter.fields_to_render).sinai_index_terms %>

  <% if sinai_index.length > 0 %>
    <% sinai_index.each do |field_name, field| %>
      <div class='metadata-block__group--collection-pg'>
        <!-- KEY -->
        <div class="blacklight-<%= field_name.parameterize %> metadata-block__label-key">
          <%= (render_document_show_field_label document, field: field_name).tr(':', '') %>
        </div>
        <!-- VALUE -->
        <div class="blacklight-<%= field_name.parameterize %> metadata-block__label-value">
          <%= doc_presenter.field_value field %>
        </div>
      </div>
    <% end %>
  <% end %>

      </div>
    </div>
  </div>
</div>

<!-- URSUS -->
<% else %>
  <% doc_presenter = index_presenter(document) %>
  <div class="document__list-item-wrapper">
    <!-- default partial to display solr document fields in catalog index view -->
    <dl class="document-metadata document__list-metadata-group">
      <% doc_presenter.fields_to_render.each do | field_name, field | %>
      <%# COLLECTIONS %>
      <% if field_name == "member_of_collections_ssim" %>
        <% if document[:member_of_collections_ssim] && document[:member_of_collection_ids_ssim] %>
          <dt class="document__list-metadata-key document__list-metadata-key--ursus blacklight-<%= field_name.parameterize %>">
            <%= render_index_field_label document, field: field_name %>
          </dt>
          <dd class="document__list-metadata-value document__list-metadata-value--ursus blacklight-<%= field_name.parameterize %>">
            <% if document[:member_of_collections_ssim].length > 1 %>
              <% document[:member_of_collections_ssim].each_with_index do | member, index | %>
                <%= link_to member, "/catalog/#{document[:member_of_collection_ids_ssim][index]}" %><br>
              <% end %>
              <% else %>
                <%= link_to document[:member_of_collections_ssim][0], "/catalog/#{document[:member_of_collection_ids_ssim][0]}" %>
              <% end %>
          </dd>
        <% end %>

        <%# WORKS %>
        <% else %>
          <dt class="document__list-metadata-key document__list-metadata-key--ursus blacklight-<%= field_name.parameterize %>">
            <%= render_index_field_label document, field: field_name %>
          </dt>
          <dd class="document__list-metadata-value document__list-metadata-value--ursus blacklight-<%= field_name.parameterize %>">
            <%= doc_presenter.field_value field %>
          </dd>
          <% if field_name == "Description" %>
            <dt class="document__list-metadata-key blacklight-<%= field_name.parameterize %>"></dt>
            <dd class="document__list-metadata-value blacklight-<%= field_name.parameterize %>">&nbsp;&nbsp;&nbsp;</dd>
          <% end %>
        <% end %>
      <% end %>
    </dl>

    <%# THUMBNAIL %>
    <% if presenter(document).thumbnail.exists? && tn = presenter(document).thumbnail.thumbnail_tag({}, counter: document_counter_with_offset(document_counter)) %>
      <div class="document__gallery-thumbnail"><%= tn %></div>
    <% end %>
  </div>
<% end %>
